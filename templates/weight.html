<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Baloo&display=swap" rel="stylesheet" />
        <link rel="icon" type="image/x-icon" href="../static/images/favicon.png">
        <link href="{{ url_for('static', filename='css/weight.css') }}" rel="stylesheet" />
        <title>Laundrylink - Weight Laundry</title>
    </head>
    <body>
        <div class="v93_70">
            <!-- Progress bar -->
            <div class="v93_72">
                <div class="v93_73"></div>
                <div class="v93_74"></div>
                <div class="v93_75"></div>
                <div class="v93_76"></div>
                <div class="v93_77"></div>
                <div class="v93_109"></div>
                <div class="v96_2"></div>
                <span class="v96_4">2</span>
            </div>
            
            <!-- Step labels below progress bar -->
            <div class="step-labels">
                <span class="v93_78">YOU</span>
                <span class="v93_79">WEIGH</span>
                <span class="v93_80">OTHER</span>
                <span class="v93_81">PAYMENT</span>
            </div>
            
            <!-- Main content container -->
            <div class="content-container">
                <div class="v93_144">
                    <div class="v95_13"></div>
                    <!-- Weight input form -->
                    <form method="POST" action="{{ url_for('weight_laundry') }}" id="weightForm">
                        <div class="weight-info">
                            <input type="number" id="weight_input" class="v95_24" name="weight" min="0" step="0.01" placeholder="Waiting for weight..." required readonly>
                            <input type="text" id="total_load" class="v95_36" name="total_load" placeholder="Total load (auto)" readonly>
                        </div>
                        <div class="button-container">
                            <a href="{{ url_for('contact') }}" class="v103_9" style="text-decoration: none;">
                                <span class="v103_10">Previous</span>
                            </a>
                            <button type="submit" class="v103_7" style="text-decoration: none;">
                                <span class="v103_8">Next</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script>
            // Poll the backend for latest weight every second
            function pollWeight() {
                fetch('/get_latest_weight')
                    .then(response => response.json())
                    .then(data => {
                        const weight = parseFloat(data.weight) || 0;
                        document.getElementById('weight_input').value = weight > 0 ? weight.toFixed(2) : '';
                        const totalLoad = weight > 0 ? Math.ceil(weight / 8) : 0;
                        document.getElementById('total_load').value = totalLoad;
                    });
            }
            setInterval(pollWeight, 1000);
            pollWeight();
        </script>
    </body>
</html>